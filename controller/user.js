var _0xf8a4=['\x20and\x20password\x20=\x20','mes_qdhd_mobile_xhykjyxgs','sign','log','token','12111s','verify','message','exports','../db/mysql','../utils/cryp','jsonwebtoken','\x0a\x20\x20\x20\x20\x20\x20\x20\x20select\x20\x20*\x20from\x20pub_user\x20where\x20username=','\x20and\x20password=','\x0a\x20\x20\x20\x20','then','\x0a\x20\x20\x20\x20\x20\x20\x20\x20select\x20\x20*\x20from\x20pub_user\x20where\x20id=','password','oldpwd','\x0a\x20\x20\x20\x20\x20\x20\x20\x20update\x20pub_user\x20set\x20password\x20=\x20','\x20where\x20id\x20=\x20'];(function(_0x46b51e,_0x486e21){var _0x5a4ec4=function(_0x95d168){while(--_0x95d168){_0x46b51e['push'](_0x46b51e['shift']());}};_0x5a4ec4(++_0x486e21);}(_0xf8a4,0xdb));var _0xa134=function(_0x4b9ace,_0x4098c6){_0x4b9ace=_0x4b9ace-0x0;var _0x58b4e=_0xf8a4[_0x4b9ace];return _0x58b4e;};const {exec,escape}=require(_0xa134('0x0'));const {genPassword}=require(_0xa134('0x1'));const jwt=require(_0xa134('0x2'));const login=(_0x22df90,_0x484df1)=>{_0x22df90=escape(_0x22df90);_0x484df1=escape(genPassword(_0x484df1));const _0x377e7d=_0xa134('0x3')+_0x22df90+_0xa134('0x4')+_0x484df1+_0xa134('0x5');return exec(_0x377e7d)[_0xa134('0x6')](_0xf9bea3=>{return _0xf9bea3[0x0]||{};});};const userInfo=_0x596427=>{const _0x1637d0=_0xa134('0x7')+_0x596427+_0xa134('0x5');return exec(_0x1637d0)[_0xa134('0x6')](_0x4d1e58=>{return _0x4d1e58[0x0];});};const resetPwd=_0x5c26be=>{let _0x538990=escape(genPassword(_0x5c26be[_0xa134('0x8')]));let _0x6f5cab=escape(genPassword(_0x5c26be[_0xa134('0x9')]));const _0x5a5ce3=_0xa134('0xa')+_0x538990+_0xa134('0xb')+_0x5c26be['id']+_0xa134('0xc')+_0x6f5cab+_0xa134('0x5');return exec(_0x5a5ce3)[_0xa134('0x6')](_0x5cac88=>{return _0x5cac88;});};var signkey=_0xa134('0xd');const setToken=function(_0x4590b2){return new Promise((_0x8decf4,_0x2983bc)=>{const _0x578d5d=jwt[_0xa134('0xe')]({'username':_0x4590b2},signkey,{'expiresIn':0x3c*0x3c*0x18*0x3});console[_0xa134('0xf')](_0xa134('0x10'),_0x578d5d);_0x8decf4(_0x578d5d);});};const verToken=function(_0x12425a){console[_0xa134('0xf')](_0xa134('0x11'));return new Promise((_0x15be33,_0x4a3c19)=>{var _0x233d39=jwt[_0xa134('0x12')](_0x12425a,signkey,(_0x1a59d7,_0x204d9b)=>{if(_0x1a59d7){console[_0xa134('0xf')](_0x1a59d7[_0xa134('0x13')]);return;}});console[_0xa134('0xf')](_0x233d39);_0x15be33(_0x233d39);});};module[_0xa134('0x14')]={'login':login,'userInfo':userInfo,'setToken':setToken,'verToken':verToken,'resetPwd':resetPwd};